-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.

--ROLLBACK;

--DROP TABLE IF EXISTS public.area CASCADE;

DROP TABLE IF EXISTS GERACAO_ENERGIA;

CREATE TABLE geracao_energia
(
    id_energia integer NOT NULL,
    sigla_area varchar(3) NOT NULL,
    quantidade double precision,
    unidade varchar(10) NOT NULL,
    ano integer
);

DROP TABLE IF EXISTS AREA;

CREATE TABLE AREA
(
    --id integer NOT NULL,
    sigla varchar(5),
    nome varchar(50) NOT NULL,
    tipo varchar(12),
    continente varchar(20),
    PRIMARY KEY (sigla)
);

DROP TABLE IF EXISTS ENERGIA;

CREATE TABLE energia
(
    id integer GENERATED BY DEFAULT AS IDENTITY,
    categoria character varying(50),
    subcategoria character varying(50),
    variavel character varying(50),
    PRIMARY KEY (id)
);

-- Tabela de atribuição de códigos às áreas sem cód
DROP TABLE IF EXISTS SIGLA_ARTIFICIAL;

CREATE TABLE SIGLA_ARTIFICIAL (
	NOME varchar(50),
	SIGLA varchar(3)
);

INSERT INTO SIGLA_ARTIFICIAL VALUES 
('Africa', 'AFR'),
('ASEAN', 'ASE'),
('Asia', 'ASI'),
('EU', 'EU'),
('Europe', 'EUR'),
('G20', 'G20'),
('G7', 'G7'),
('Latin America and Caribbean', 'LAC'),
('Middle East', 'ME'),
('North America', 'NA'),
('Oceania', 'OCE'),
('OECD', 'OEC'),
('World', 'WRL');

ALTER TABLE IF EXISTS geracao_energia
    ADD FOREIGN KEY (id_energia)
    REFERENCES energia (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

ALTER TABLE IF EXISTS geracao_energia
    ADD FOREIGN KEY (sigla_area)
    REFERENCES area (sigla) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;